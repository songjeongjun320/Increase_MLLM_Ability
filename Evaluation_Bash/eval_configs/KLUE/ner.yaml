task: ner
dataset_path: klue
dataset_name: ner
test_split: validation

output_type: generate_until

generation_kwargs:
  until: ["\n\n", "\n"]
  max_gen_toks: 300
  temperature: 0.0

metric_list:
  - metric: exact_match
    aggregation: mean
    higher_is_better: true

description: "문장에서 개체명을 인식하고 BIO 태그를 붙이세요."

doc_to_text: |
  문장: {{sentence}}

  위 문장의 각 토큰에 대해 BIO 태그를 붙여주세요. 형식: 토큰1/태그1 토큰2/태그2 ...
  가능한 태그: B-DT, I-DT, B-LC, I-LC, B-OG, I-OG, B-PS, I-PS, B-QT, I-QT, B-TI, I-TI, O

  결과:

# NER 태그를 문자열로 변환 (숫자 인덱스를 태그명으로 매핑)
doc_to_target: |
  {% set tag_names = ['B-DT', 'I-DT', 'B-LC', 'I-LC', 'B-OG', 'I-OG', 'B-PS', 'I-PS', 'B-QT', 'I-QT', 'B-TI', 'I-TI', 'O'] %}
  {% set result = [] %}
  {% for i in range(tokens|length) %}
    {% set token = tokens[i] %}
    {% set tag_idx = ner_tags[i] %}
    {% set tag = tag_names[tag_idx] %}
    {% set _ = result.append(token + '/' + tag) %}
  {% endfor %}
  {{ result|join(' ') }}

filter_list:
  - name: "whitespace"
    filter:
      - function: "take_first"

fewshot_config:
  sampler: first_n

num_fewshot: 2  # NER은 복잡하므로 적은 few-shot
should_decontaminate: true
metadata:
  version: 1.0